package com.digi3studio {	import asset.CardBackgroundImage;	import com.fastframework.core.FASTEventDispatcher;	import flash.display.BitmapData;	import flash.display.Sprite;	import flash.geom.Matrix;	import flash.utils.ByteArray;	/**	 * @author Digi3Studio - Colin Leung	 * compose the background;	 * scale the picture for attachment.	 */	public class PhotoComposition extends FASTEventDispatcher {		private var scale:Number;		private var cardWidth:Number;		private var cardHeight:Number;		private var composition:ByteArray;		private var imgEncoder:IBitmapDataEncoder;		public function PhotoComposition(imgEncoder:IBitmapDataEncoder,scale:Number,cardWidth:int,cardHeight:int) {			this.imgEncoder = imgEncoder;			this.scale = scale;			this.cardWidth = cardWidth;			this.cardHeight= cardHeight;		}		public function composeAsByteArray(mcPreview : Sprite, metaData : Object) : ByteArray {//			var bdCard:BitmapData = new BitmapData(1020,627,false,0xFAA600);			var bdCard:BitmapData = new BitmapData(this.cardWidth,this.cardHeight,true,0xFAA600);			var tmx:Matrix = new Matrix();			tmx.scale(scale,scale);			bdCard.draw(new CardBackgroundImage());			bdCard.draw(mcPreview,tmx,null,null,null,true);			composition = imgEncoder.encode(bdCard,metaData);			return composition;		}				public function getCompositionByteArray():ByteArray{			return composition;		}	}}